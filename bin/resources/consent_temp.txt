Compliant(Controller, Subject) -< DataSubject(Subject), DataController(Controller), ValidConsent(Controller,Subject).
~Compliant(Controller, Subject) -< DataSubject(Subject), DataController(Controller), ~ValidConsent(Controller,Subject).

Undecided(C,S) -< DataSubject(S), DataController(C), Test(C).

%Valid Consent

ValidConsent(C,S) -< DataSubject(S), DataController(C).

~ValidConsent(C,S) <- ~GivenConsent(C,S).
~ValidConsent(C,S) <- ~UnambiguousConsent(C,S).
~ValidConsent(C,S) <- ~FreelyGivenConsent(C,S).
~ValidConsent(C,S) <- WithdrawnConsent(C,S).

%Affirmitive Consent

AffirmitiveConsent(C,S) -< ConsentInput(C,S,"Tickbox").
AffirmitiveConsent(C,S) -< ConsentInput(C,S,"Button").
AffirmitiveConsent(C,S) -< ConsentInput(C,S,"Signature").
~AffirmitiveConsent(C,S) <- ConsentInput(C,S,"Assumed").
~AffirmitiveConsent(C,S) <- ConsentInput(C,S,"PrecheckedTickbox").

%Unambiguous consent

UnambiguousConsent(C,S) -< DataSubject(S), DataController(C).
~UnambiguousConsent(C,S) <- ~AffirmitiveConsent(C,S).
~UnambiguousConsent(C,S) <- ~ConsentGiven(C,S).

%Specified and informed consent

SpecifiedAndInformedConsent(C,S) -< DataSubject(S), DataController(C).
~SpecifiedAndInformedConsent(C,S) <- ~ShowsControllerIdentity(C,S).
~SpecifiedAndInformedConsent(C,S) <- ~ShowsProcessingPurpose(C,S).
~SpecifiedAndInformedConsent(C,S) <- ~ShowsProcessingActivities(C,S).
~SpecifiedAndInformedConsent(C,S) <- ~RightToWithdrawConsent(C,S).
~SpecifiedAndInformedConsent(C,S) <- ~GivenConsent(C,S).


%Freely given

FreelyGivenConsent(C,S) -< DataSubject(S), DataController(C).
~FreelyGivenConsent(C,S) <- GivenConsent(C,S), ConsentConditionOfService(C).
~FreelyGivenConsent(C,S) <- ~GivenConsent(C,S).



%Facts
DataSubject(user1).
DataController(fitbit).

GivenConsent(fitbit,user1).
ConsentInput(fitbit,user1,"Tickbox").
ShowsControllerIdentity(fitbit,user1).
ShowsProcessingPurpose(fitbit,user1).
ShowsProcessingActivities(fitbit,user1).
RightToWithdrawConsent(fitbit,user1).
~ConsentConditionOfService(fitbit).
~WithdrawnConsent(fitbit,user1).




